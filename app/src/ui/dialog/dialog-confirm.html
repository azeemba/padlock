<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../styles/shared.html">
<link rel="import" href="dialog.html">

<dom-module id="pl-dialog-confirm">

    <template>
        <style include="shared"></style>

        <pl-dialog open="{{ open }}" prevent-dismiss class="tiles">
            <div class="message">{{ message }}</div>
            <button on-click="_confirm">{{ confirmLabel }}</button>
            <button on-click="_cancel">{{ cancelLabel }}</button>
        </pl-dialog>
    </template>

    <script>
(() => {

const defaultMessage = "Are you sure you want to do this?";
const defaultConfirmLabel = "Confirm";
const defaultCancelLabel = "Cancel";

class DialogConfirm extends Polymer.Element {

    static get is() { return "pl-dialog-confirm"; }

    static get properties() { return {
        confirmLabel: { type: String, value: defaultConfirmLabel },
        cancelLabel: { type: String, value: defaultCancelLabel },
        message: { type: String, value: defaultMessage },
        open: { type: Boolean, value: false }
    }; }

    _confirm() {
        this.dispatchEvent(new CustomEvent("dialog-confirm", { bubbles: true, composed: true }));
        this.open = false;
        typeof (this._resolve === "function") && this._resolve(true);
        this._resolve = null;
    }

    _cancel() {
        this.dispatchEvent(new CustomEvent("dialog-cancel", { bubbles: true, composed: true }));
        this.open = false;
        typeof (this.resolve === "function") && this._resolve(false);
        this._resolve = null;
    }

    confirm(message, confirmLabel, cancelLabel) {
        this.message = message || this.message || defaultMessage;
        this.confirmLabel = confirmLabel || this.confirmLabel || defaultConfirmLabel;
        this.cancelLabel = cancelLabel || this.cancelLabel || defaultCancelLabel;
        this.open = true;

        return new Promise((resolve) => {
            this._resolve = resolve;
        });
    }
}

window.customElements.define(DialogConfirm.is, DialogConfirm);

})();
    </script>

</dom-module>
