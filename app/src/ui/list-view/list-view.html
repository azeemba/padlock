<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/iron-list/iron-list.html">
<link rel="import" href="../../styles/shared.html">
<link rel="import" href="../icon/icon.html">
<link rel="import" href="../record-item/record-item.html">

<dom-module id="pl-list-view">
    <template>

        <style include="shared">
            :host {
                --gutter-width: 2px;
                @apply --fullbleed;
                overflow-x: hidden;
                overflow-y: auto;
                -webkit-overflow-scrolling: touch;
                box-sizing: border-box;
                display: flex;
                flex-direction: column;
                height: 100%;
            }

            header > div {
                flex: 1;
            }

            header input {
                width: 100%;
                padding-left: 15px;
            }

            header input:not(:focus) ~ pl-icon[icon="cancel"] {
                display: none;
            }

            header input:focus ~ pl-icon:not([icon="cancel"]) {
                display: none;
            }

            main {
                display: flex;
                flex-direction: column;
                overflow: hidden;
            }

            iron-list {
                flex: 1;
            }

            .empty {
                flex: 1;
                display: flex;
                flex-direction: column;
            }

            .empty-message {
                padding: 15px;
                text-align: center;
            }

            pl-record-item {
                @apply --tap-highlight;
            }

            pl-record-item::after {
                @apply --tap-highlight-after;
            }

            pl-record-item:focus::after {
                @apply --tap-highlight-hover-after;
            }

            pl-record-item.selected::after {
                @apply --tap-highlight-active-after;
            }

            header pl-icon[arrow] {
                position: relative;
                overflow: hidden;
            }

            header pl-icon[arrow]::before {
                content: "";
                display: block;
                width: 15px;
                height: 15px;
                position: absolute;
                bottom: -7px;
                left: 0;
                right: 0;
                margin: 0 auto;
                transform: rotate(45deg);
                background: rgba(0, 0, 0, 0.1);
                pointer-events: none;
            }
        </style>

        <header>
            <div class="tap">
                <input class="tiles-1" placeholder="Type to search..." value="{{ _filterString::input }}"></input>
            </div>
            <pl-icon icon="add" arrow$="[[ _isEmpty(records.length) ]]" class="tiles-2 tap" on-click="_newRecord" hidden$="{{ _filterActive(_filterString) }}"></pl-icon>
            <pl-icon icon="cloud" class="tiles-3 tap" on-click="" hidden$="{{ _filterActive(_filterString) }}"></pl-icon>
            <pl-icon icon="lock" class="tiles-4 tap" on-click="_lock" hidden$="{{ _filterActive(_filterString) }}"></pl-icon>
            <pl-icon icon="settings" class="tiles-5 tap" on-click="" hidden$="{{ _filterActive(_filterString) }}"></pl-icon>
            <pl-icon icon="cancel" class="tiles-2 tap" on-click="_clearFilter" hidden$="{{ !_filterActive(_filterString) }}"></pl-icon>
        </header>

        <main>

            <iron-list id="list" selection-enabled hidden$="[[ _isEmpty(records.length) ]]"
                items="[[ _filterAndSort(records, _filterString) ]]"
                selected-item="{{ selectedRecord }}">
                <template>
                    <div>
                        <pl-record-item record="[[ item ]]" class$="[[ _itemClass(index, selected) ]]" tabindex$="[[ tabIndex ]]"></pl-record-item>
                    </div>
                </template>
            </iron-list>

            <div hidden$="[[ !_isEmpty(records.length) ]]" class="empty tiles tiles-3">
                <div class="empty-message">
                    You don't have any data yet! Start by creating your first record!
                </div>
                <div class="spacer"></div>
            </div>

        </main>

    </template>

    <script src="list-view.js"></script>

</dom-module>
